
img.jfp = paste0(data.dir,"/S2A_MSIL1C_20170101T082332_N0204_R121_T34JFP_20170101T084543.SAFE/GRANULE/L1C_T34JFP_A007983_20170101T084543/IMG_DATA")

img.dir3 = paste0(data.dir,"/S2A_MSIL1C_20170312T082001_N0204_R121_T34JFP_20170312T084235.SAFE/GRANULE/L1C_T34JFP_A008984_20170312T084235/IMG_DATA")

# img.dir6 = paste0(data.dir,"/S2A_MSIL1C_20170620T082011_N0205_R121_T34JFP_20170620T084200.SAFE/GRANULE/L1C_T34JFP_A010414_20170620T084200/IMG_DATA")


img.dir7 = paste0(data.dir,"/S2B_MSIL1C_20170804T081559_N0205_R121_T34JFP_20170804T084631.SAFE/GRANULE/L1C_T34JFP_A002149_20170804T084631/IMG_DATA")

img.dir8 = paste0(data.dir,"/S2A_MSIL1C_20170819T082011_N0205_R121_T34JFP_20170819T084427.SAFE/GRANULE/L1C_T34JFP_A011272_20170819T084427/IMG_DATA")

img.dir5 = paste0(data.dir,"/S2A_MSIL1C_20170531T082011_N0205_R121_T34JFP_20170531T084246.SAFE/GRANULE/L1C_T34JFP_A010128_20170531T084246/IMG_DATA")


img.dir6 = paste0(data.dir,"/S2A_MSIL1C_20170131T082151_N0204_R121_T34JFP_20170131T084118.SAFE/GRANULE/L1C_T34JFP_A008412_20170131T084118/IMG_DATA")

img.dir4 = paste0(data.dir,"/S2B_MSIL1C_20170715T081609_N0205_R121_T34JFP_20170715T084650.SAFE/GRANULE/L1C_T34JFP_A001863_20170715T084650/IMG_DATA")

img.dir42 = paste0(data.dir,"/S2A_MSIL1C_20170710T082011_N0205_R121_T34JFP_20170710T084244.SAFE/GRANULE/L1C_T34JFP_A010700_20170710T084244/IMG_DATA")

img.dir2 = paste0(data.dir,"/S2A_MSIL1C_20170210T082051_N0204_R121_T34JFP_20170210T083752.SAFE/GRANULE/L1C_T34JFP_A008555_20170210T083752/IMG_DATA")

img.dir1 = paste0(data.dir,"/S2A_MSIL1C_20170322T081611_N0204_R121_T34JFP_20170322T084728.SAFE/GRANULE/L1C_T34JFP_A009127_20170322T084728/IMG_DATA")

img.dir66 = paste0(data.dir,"/S2A_MSIL1C_20170620T082011_N0205_R121_T34JFP_20170620T084200.SAFE/GRANULE/L1C_T34JFP_A010414_20170620T084200/IMG_DATA")




#### Load Raster 
band1 = raster::raster(paste0(img.jfp,'/T34JFP_20170101T082332_B01.jp2'))
band2 = raster::raster(paste0(img.jfp,'/T34JFP_20170101T082332_B02.jp2'))
band3 = raster::raster(paste0(img.jfp,'/T34JFP_20170101T082332_B03.jp2'))
band4 = raster::raster(paste0(img.jfp,'/T34JFP_20170101T082332_B04.jp2'))
band5 = raster::raster(paste0(img.jfp,'/T34JFP_20170101T082332_B05.jp2'))
band6 = raster::raster(paste0(img.jfp,'/T34JFP_20170101T082332_B06.jp2'))
band7 = raster::raster(paste0(img.jfp,'/T34JFP_20170101T082332_B07.jp2'))
band8 = raster::raster(paste0(img.jfp,'/T34JFP_20170101T082332_B08.jp2'))
band8A = raster::raster(paste0(img.jfp,'/T34JFP_20170101T082332_B8A.jp2'))
band9 = raster::raster(paste0(img.jfp,'/T34JFP_20170101T082332_B09.jp2'))
band10 = raster::raster(paste0(img.jfp,'/T34JFP_20170101T082332_B10.jp2'))
band11 = raster::raster(paste0(img.jfp,'/T34JFP_20170101T082332_B11.jp2'))
band12 = raster::raster(paste0(img.jfp,'/T34JFP_20170101T082332_B12.jp2'))
#ndvi = band8 - band4
####
#ndvi_11_5 = NDVI(band11,band5)
## band 1,band 6, band 3
q = raster::extract(band1,train_points)
q2 = raster::extract(band2,train_points)
q3 = raster::extract(band3,train_points)
q4 = raster::extract(band4,train_points)
q5 = raster::extract(band5,train_points)
q6 = raster::extract(band6,train_points)
q7 = raster::extract(band7,train_points)
q8 = raster::extract(band8,train_points)
q8A = raster::extract(band8A,train_points)
q9 = raster::extract(band9,train_points)
q10 = raster::extract(band10,train_points)
q11 = raster::extract(band11,train_points)
q12 = raster::extract(band12,train_points)
#q12 = raster::extract(ndvi_11_5,train_points)

df_train$band1 = ifelse(is.na(df_train$band1),q,df_train$band1)
df_train$band2 = ifelse(is.na(df_train$band2),q2,df_train$band2)
df_train$band3 = ifelse(is.na(df_train$band3),q3,df_train$band3)
df_train$band4 = ifelse(is.na(df_train$band4),q4,df_train$band4)
df_train$band5 = ifelse(is.na(df_train$band5),q5,df_train$band5)
df_train$band6 = ifelse(is.na(df_train$band6),q6,df_train$band6)
df_train$band7 = ifelse(is.na(df_train$band7),q7,df_train$band7)
df_train$band8 = ifelse(is.na(df_train$band8),q8,df_train$band8)
df_train$band8A = ifelse(is.na(df_train$band8A),q8A,df_train$band8A)
df_train$band9 = ifelse(is.na(df_train$band9),q9,df_train$band9)
df_train$band10 = ifelse(is.na(df_train$band10),q10,df_train$band10)
df_train$band11 = ifelse(is.na(df_train$band11),q11,df_train$band11)
df_train$band12 = ifelse(is.na(df_train$band12),q12,df_train$band12)
#df_train$ndvi_1 = ifelse(is.na(df_train$ndvi_1),q12,df_train$ndvi_1)
###
q = raster::extract(band1, test_points)
q2 = raster::extract(band2, test_points)
q3 = raster::extract(band3, test_points)
q4 = raster::extract(band4, test_points)
q5 = raster::extract(band5, test_points)
q6 = raster::extract(band6, test_points)
q7 = raster::extract(band7, test_points)
q8 = raster::extract(band8, test_points)
q9 = raster::extract(band9, test_points)
q10 = raster::extract(band10, test_points)
q11 = raster::extract(band11, test_points)
#q12 = raster::extract(ndvi_11_5,test_points)

df_test$band1 = ifelse(is.na(df_test$band1),q,df_test$band1)
df_test$band2 = ifelse(is.na(df_test$band2),q2,df_test$band2)
df_test$band3 = ifelse(is.na(df_test$band3),q3,df_test$band3)
df_test$band4 = ifelse(is.na(df_test$band4),q4,df_test$band4)
df_test$band5 = ifelse(is.na(df_test$band5),q5,df_test$band5)
df_test$band6 = ifelse(is.na(df_test$band6),q6,df_test$band6)
df_test$band7 = ifelse(is.na(df_test$band7),q7,df_test$band7)
df_test$band8 = ifelse(is.na(df_test$band8),q8,df_test$band8)
df_test$band9 = ifelse(is.na(df_test$band9),q9,df_test$band9)
df_test$band10 = ifelse(is.na(df_test$band10),q10,df_test$band10)
df_test$band11 = ifelse(is.na(df_test$band11),q11,df_test$band11)
#df_test$ndvi_1 = ifelse(is.na(df_test$ndvi_1),q12,df_test$ndvi_1)
###### 2017-08-04
###


###### 2017-05-31
band1 = raster::raster(paste0(img.dir5,'/T34JFP_20170531T082011_B01.jp2'))
band2 = raster::raster(paste0(img.dir5,'/T34JFP_20170531T082011_B02.jp2'))
band3 = raster::raster(paste0(img.dir5,'/T34JFP_20170531T082011_B03.jp2'))
band4 = raster::raster(paste0(img.dir5,'/T34JFP_20170531T082011_B04.jp2'))
band5 = raster::raster(paste0(img.dir5,'/T34JFP_20170531T082011_B05.jp2'))
band6 = raster::raster(paste0(img.dir5,'/T34JFP_20170531T082011_B06.jp2'))
band7 = raster::raster(paste0(img.dir5,'/T34JFP_20170531T082011_B07.jp2'))
band8 = raster::raster(paste0(img.dir5,'/T34JFP_20170531T082011_B08.jp2'))
band8A = raster::raster(paste0(img.dir5,'/T34JFP_20170531T082011_B8A.jp2'))
band9 = raster::raster(paste0(img.dir5,'/T34JFP_20170531T082011_B09.jp2'))
band10 = raster::raster(paste0(img.dir5,'/T34JFP_20170531T082011_B10.jp2'))
band11 = raster::raster(paste0(img.dir5,'/T34JFP_20170531T082011_B11.jp2'))
band12 = raster::raster(paste0(img.dir5,'/T34JFP_20170531T082011_B12.jp2'))
#ndvi_11_5 = NDVI(band11,band5)
##
q = raster::extract(band1,train_points)
q2 = raster::extract(band2,train_points)
q3 = raster::extract(band3,train_points)
q4 = raster::extract(band4,train_points)
q5 = raster::extract(band5,train_points)
q6 = raster::extract(band6,train_points)
q7 = raster::extract(band7,train_points)
q8 = raster::extract(band8,train_points)
q8A = raster::extract(band8A,train_points)
q9 = raster::extract(band9,train_points)
q10 = raster::extract(band10,train_points)
q11 = raster::extract(band11,train_points)
q12 = raster::extract(band12,train_points)[-2402]

#q12 = raster::extract(ndvi_11_5,train_points)

df_train$band1_5 = ifelse(is.na(df_train$band1_5),q,df_train$band1_5)
df_train$band2_5 = ifelse(is.na(df_train$band2_5),q2,df_train$band2_5)
df_train$band3_5 = ifelse(is.na(df_train$band3_5),q3,df_train$band3_5)
df_train$band4_5 = ifelse(is.na(df_train$band4_5),q4,df_train$band4_5)
df_train$band5_5 = ifelse(is.na(df_train$band5_5),q5,df_train$band5_5)
df_train$band6_5 = ifelse(is.na(df_train$band6_5),q6,df_train$band6_5)
df_train$band7_5 = ifelse(is.na(df_train$band7_5),q7,df_train$band7_5)
df_train$band8_5 = ifelse(is.na(df_train$band8_5),q8,df_train$band8_5)
df_train$band8A_5 = ifelse(is.na(df_train$band8A_5),q8A,df_train$band8A_5)
df_train$band9_5 = ifelse(is.na(df_train$band9_5),q9,df_train$band9_5)
df_train$band10_5 = ifelse(is.na(df_train$band10_5),q10,df_train$band10_5)
df_train$band11_5 = ifelse(is.na(df_train$band11_5),q11,df_train$band11_5)
df_train$band12_5 = ifelse(is.na(df_train$band12_5),q12,df_train$band12_5)
#df_train$ndvi_1_5 = ifelse(is.na(df_train$ndvi_1_5),q12,df_train$ndvi_1_5)

q = raster::extract(band1, test_points)
q2 = raster::extract(band2, test_points)
q3 = raster::extract(band3, test_points)
q4 = raster::extract(band4, test_points)
q5 = raster::extract(band5, test_points)
q6 = raster::extract(band6, test_points)
q7 = raster::extract(band7, test_points)
q8 = raster::extract(band8, test_points)
q8A = raster::extract(band8A, test_points)
q9 = raster::extract(band9, test_points)
q10 = raster::extract(band10, test_points)
q11 = raster::extract(band11, test_points)
q12 = raster::extract(band12, test_points)
#q12 = raster::extract(ndvi_11_5,test_points)

df_test$band1_5 = ifelse(is.na(df_test$band1_5),q,df_test$band1_5)
df_test$band2_5 = ifelse(is.na(df_test$band2_5),q2,df_test$band2_5)
df_test$band3_5 = ifelse(is.na(df_test$band3_5),q3,df_test$band3_5)
df_test$band4_5 = ifelse(is.na(df_test$band4_5),q4,df_test$band4_5)
df_test$band5_5 = ifelse(is.na(df_test$band5_5),q5,df_test$band5_5)
df_test$band6_5 = ifelse(is.na(df_test$band6_5),q6,df_test$band6_5)
df_test$band7_5 = ifelse(is.na(df_test$band7_5),q7,df_test$band7_5)
df_test$band8_5 = ifelse(is.na(df_test$band8_5),q8,df_test$band8_5)
df_test$band8A_5 = ifelse(is.na(df_test$band8A_5),q8A,df_test$band8A_5)
df_test$band9_5 = ifelse(is.na(df_test$band9_5),q9,df_test$band9_5)
df_test$band10_5 = ifelse(is.na(df_test$band10_5),q10,df_test$band10_5)
df_test$band11_5 = ifelse(is.na(df_test$band11_5),q11,df_test$band11_5)
df_test$band12_5 = ifelse(is.na(df_test$band12_5),q12,df_test$band12_5)
#df_test$ndvi_1_5 = ifelse(is.na(df_test$ndvi_1_5),q12,df_test$ndvi_1_5)

###### 2017-08-04


###### 2017-08-19
band1 = raster::raster(paste0(img.dir8,'/T34JFP_20170819T082011_B01.jp2'))
band2 = raster::raster(paste0(img.dir8,'/T34JFP_20170819T082011_B02.jp2'))
band3 = raster::raster(paste0(img.dir8,'/T34JFP_20170819T082011_B03.jp2'))
band4 = raster::raster(paste0(img.dir8,'/T34JFP_20170819T082011_B04.jp2'))
band5 = raster::raster(paste0(img.dir8,'/T34JFP_20170819T082011_B05.jp2'))
band6 = raster::raster(paste0(img.dir8,'/T34JFP_20170819T082011_B06.jp2'))
band7 = raster::raster(paste0(img.dir8,'/T34JFP_20170819T082011_B07.jp2'))
band8 = raster::raster(paste0(img.dir8,'/T34JFP_20170819T082011_B08.jp2'))
band9 = raster::raster(paste0(img.dir8,'/T34JFP_20170819T082011_B09.jp2'))
band10 = raster::raster(paste0(img.dir8,'/T34JFP_20170819T082011_B10.jp2'))
band11 = raster::raster(paste0(img.dir8,'/T34JFP_20170819T082011_B11.jp2'))
#ndvi_11_5 = NDVI(band11,band5)
##
q = raster::extract(band1,train_points)
q2 = raster::extract(band2,train_points)
q3 = raster::extract(band3,train_points)
q4 = raster::extract(band4,train_points)
q5 = raster::extract(band5,train_points)
q6 = raster::extract(band6,train_points)
q7 = raster::extract(band7,train_points)
q8 = raster::extract(band8,train_points)
q9 = raster::extract(band9,train_points)
q10 = raster::extract(band10,train_points)
q11 = raster::extract(band11,train_points)
#q12 = raster::extract(ndvi_11_5,train_points)


df_train$band1_8 = ifelse(is.na(df_train$band1_8),q,df_train$band1_8)
df_train$band2_8 = ifelse(is.na(df_train$band2_8),q2,df_train$band2_8)
df_train$band3_8 = ifelse(is.na(df_train$band3_8),q3,df_train$band3_8)
df_train$band4_8 = ifelse(is.na(df_train$band4_8),q4,df_train$band4_8)
df_train$band5_8 = ifelse(is.na(df_train$band5_8),q5,df_train$band5_8)
df_train$band6_8 = ifelse(is.na(df_train$band6_8),q6,df_train$band6_8)
df_train$band7_8 = ifelse(is.na(df_train$band7_8),q7,df_train$band7_8)
df_train$band8_8 = ifelse(is.na(df_train$band8_8),q8,df_train$band8_8)
df_train$band9_8 = ifelse(is.na(df_train$band9_8),q9,df_train$band9_8)
df_train$band10_8 = ifelse(is.na(df_train$band10_8),q10,df_train$band10_8)
df_train$band11_8 = ifelse(is.na(df_train$band11_8),q11,df_train$band11_8)
#df_train$ndvi_1_8 = ifelse(is.na(df_train$ndvi_1_8),q12,df_train$ndvi_1_8)
###
q = raster::extract(band1, test_points)
q2 = raster::extract(band2, test_points)
q3 = raster::extract(band3, test_points)
q4 = raster::extract(band4, test_points)
q5 = raster::extract(band5, test_points)
q6 = raster::extract(band6, test_points)
q7 = raster::extract(band7, test_points)
q8 = raster::extract(band8, test_points)
q9 = raster::extract(band9, test_points)
q10 = raster::extract(band10, test_points)
q11 = raster::extract(band11, test_points)
#q12 = raster::extract(ndvi_11_5,test_points)

df_test$band1_8 = ifelse(is.na(df_test$band1_8),q,df_test$band1_8)
df_test$band2_8 = ifelse(is.na(df_test$band2_8),q2,df_test$band2_8)
df_test$band3_8 = ifelse(is.na(df_test$band3_8),q3,df_test$band3_8)
df_test$band4_8 = ifelse(is.na(df_test$band4_8),q4,df_test$band4_8)
df_test$band5_8 = ifelse(is.na(df_test$band5_8),q5,df_test$band5_8)
df_test$band6_8 = ifelse(is.na(df_test$band6_8),q6,df_test$band6_8)
df_test$band7_8 = ifelse(is.na(df_test$band7_8),q7,df_test$band7_8)
df_test$band8_8 = ifelse(is.na(df_test$band8_8),q8,df_test$band8_8)
df_test$band9_8 = ifelse(is.na(df_test$band9_8),q9,df_test$band9_8)
df_test$band10_8 = ifelse(is.na(df_test$band10_8),q10,df_test$band10_8)
df_test$band11_8 = ifelse(is.na(df_test$band11_8),q11,df_test$band11_8)
#df_test$ndvi_1_8 = ifelse(is.na(df_test$ndvi_1_8),q12,df_test$ndvi_1_8)

###### 2017-08-04

###### 2017-03-12
band1 = raster::raster(paste0(img.dir3,'/T34JFP_20170312T082001_B01.jp2'))
band2 = raster::raster(paste0(img.dir3,'/T34JFP_20170312T082001_B02.jp2'))
band3 = raster::raster(paste0(img.dir3,'/T34JFP_20170312T082001_B03.jp2'))
band4 = raster::raster(paste0(img.dir3,'/T34JFP_20170312T082001_B04.jp2'))
band5 = raster::raster(paste0(img.dir3,'/T34JFP_20170312T082001_B05.jp2'))
band6 = raster::raster(paste0(img.dir3,'/T34JFP_20170312T082001_B06.jp2'))
band7 = raster::raster(paste0(img.dir3,'/T34JFP_20170312T082001_B07.jp2'))
band8 = raster::raster(paste0(img.dir3,'/T34JFP_20170312T082001_B08.jp2'))
band9 = raster::raster(paste0(img.dir3,'/T34JFP_20170312T082001_B09.jp2'))
band10 = raster::raster(paste0(img.dir3,'/T34JFP_20170312T082001_B10.jp2'))
band11 = raster::raster(paste0(img.dir3,'/T34JFP_20170312T082001_B11.jp2'))
band12 = raster::raster(paste0(img.dir3,'/T34JFP_20170312T082001_B12.jp2'))

#ndvi_11_5 = NDVI(band11,band5)
##
q = raster::extract(band1,train_points)
q2 = raster::extract(band2,train_points)
q3 = raster::extract(band3,train_points)
q4 = raster::extract(band4,train_points)
q5 = raster::extract(band5,train_points)
q6 = raster::extract(band6,train_points)
q7 = raster::extract(band7,train_points)
q8 = raster::extract(band8,train_points)
q9 = raster::extract(band9,train_points)
q10 = raster::extract(band10,train_points)
q11 = raster::extract(band11,train_points)
q12 = raster::extract(band12,train_points)[-2402]
#q12 = raster::extract(ndvi_11_5,train_points)


df_train$band1_12 = ifelse(is.na(df_train$band1_12),q,df_train$band1_12)
df_train$band2_12 = ifelse(is.na(df_train$band2_12),q2,df_train$band2_12)
df_train$band3_12 = ifelse(is.na(df_train$band3_12),q3,df_train$band3_12)
df_train$band4_12 = ifelse(is.na(df_train$band4_12),q4,df_train$band4_12)
df_train$band5_12 = ifelse(is.na(df_train$band5_12),q5,df_train$band5_12)
df_train$band6_12 = ifelse(is.na(df_train$band6_12),q6,df_train$band6_12)
df_train$band7_12 = ifelse(is.na(df_train$band7_12),q7,df_train$band7_12)
df_train$band8_12 = ifelse(is.na(df_train$band8_12),q8,df_train$band8_12)
df_train$band9_12 = ifelse(is.na(df_train$band9_12),q9,df_train$band9_12)
df_train$band10_12 = ifelse(is.na(df_train$band10_12),q10,df_train$band10_12)
df_train$band11_12 = ifelse(is.na(df_train$band11_12),q11,df_train$band11_12)
df_train$band12_12 = ifelse(is.na(df_train$band12_12),q12,df_train$band12_12)

#df_train$ndvi_1_12 = ifelse(is.na(df_train$ndvi_1_12),q12,df_train$ndvi_1_12)
###
q = raster::extract(band1, test_points)
q2 = raster::extract(band2, test_points)
q3 = raster::extract(band3, test_points)
q4 = raster::extract(band4, test_points)
q5 = raster::extract(band5, test_points)
q6 = raster::extract(band6, test_points)
q7 = raster::extract(band7, test_points)
q8 = raster::extract(band8, test_points)
q9 = raster::extract(band9, test_points)
q10 = raster::extract(band10, test_points)
q11 = raster::extract(band11, test_points)
q12 = raster::extract(band12, test_points)
#q12 = raster::extract(ndvi_11_5,test_points)


df_test$band1_12 = ifelse(is.na(df_test$band1_12),q,df_test$band1_12)
df_test$band2_12 = ifelse(is.na(df_test$band2_12),q2,df_test$band2_12)
df_test$band3_12 = ifelse(is.na(df_test$band3_12),q3,df_test$band3_12)
df_test$band4_12 = ifelse(is.na(df_test$band4_12),q4,df_test$band4_12)
df_test$band5_12 = ifelse(is.na(df_test$band5_12),q5,df_test$band5_12)
df_test$band6_12 = ifelse(is.na(df_test$band6_12),q6,df_test$band6_12)
df_test$band7_12 = ifelse(is.na(df_test$band7_12),q7,df_test$band7_12)
df_test$band8_12 = ifelse(is.na(df_test$band8_12),q8,df_test$band8_12)
df_test$band9_12 = ifelse(is.na(df_test$band9_12),q9,df_test$band9_12)
df_test$band10_12 = ifelse(is.na(df_test$band10_12),q10,df_test$band10_12)
df_test$band11_12 = ifelse(is.na(df_test$band11_12),q11,df_test$band11_12)
df_test$band12_12 = ifelse(is.na(df_test$band12_12),q12,df_test$band12_12)
#df_test$ndvi_1_12 = ifelse(is.na(df_test$ndvi_1_12),q12,df_test$ndvi_1_12)

#############################
###### 2017-08-04
band1 = raster::raster(paste0(img.dir7,'/T34JFP_20170804T081559_B01.jp2'))
band2 = raster::raster(paste0(img.dir7,'/T34JFP_20170804T081559_B02.jp2'))
band3 = raster::raster(paste0(img.dir7,'/T34JFP_20170804T081559_B03.jp2'))
band4 = raster::raster(paste0(img.dir7,'/T34JFP_20170804T081559_B04.jp2'))
band5 = raster::raster(paste0(img.dir7,'/T34JFP_20170804T081559_B05.jp2'))
band6 = raster::raster(paste0(img.dir7,'/T34JFP_20170804T081559_B06.jp2'))
band7 = raster::raster(paste0(img.dir7,'/T34JFP_20170804T081559_B07.jp2'))
band8 = raster::raster(paste0(img.dir7,'/T34JFP_20170804T081559_B08.jp2'))
band9 = raster::raster(paste0(img.dir7,'/T34JFP_20170804T081559_B09.jp2'))
band10 = raster::raster(paste0(img.dir7,'/T34JFP_20170804T081559_B10.jp2'))
band11 = raster::raster(paste0(img.dir7,'/T34JFP_20170804T081559_B11.jp2'))
#ndvi_11_5 = NDVI(band11,band5)
##
q = raster::extract(band1,train_points)
q2 = raster::extract(band2,train_points)
q3 = raster::extract(band3,train_points)
q4 = raster::extract(band4,train_points)
q5 = raster::extract(band5,train_points)
q6 = raster::extract(band6,train_points)
q7 = raster::extract(band7,train_points)
q8 = raster::extract(band8,train_points)
q9 = raster::extract(band9,train_points)
q10 = raster::extract(band10,train_points)
q11 = raster::extract(band11,train_points)
#q12 = raster::extract(ndvi_11_5,train_points)

df_train$band1_7 = ifelse(is.na(df_train$band1_7),q,df_train$band1_7)
df_train$band2_7 = ifelse(is.na(df_train$band2_7),q2,df_train$band2_7)
df_train$band3_7 = ifelse(is.na(df_train$band3_7),q3,df_train$band3_7)
df_train$band4_7 = ifelse(is.na(df_train$band4_7),q4,df_train$band4_7)
df_train$band5_7 = ifelse(is.na(df_train$band5_7),q5,df_train$band5_7)
df_train$band6_7 = ifelse(is.na(df_train$band6_7),q6,df_train$band6_7)
df_train$band7_7 = ifelse(is.na(df_train$band7_7),q7,df_train$band7_7)
df_train$band8_7 = ifelse(is.na(df_train$band8_7),q8,df_train$band8_7)
df_train$band9_7 = ifelse(is.na(df_train$band9_7),q9,df_train$band9_7)
df_train$band10_7 = ifelse(is.na(df_train$band10_7),q10,df_train$band10_7)
df_train$band11_7 = ifelse(is.na(df_train$band11_7),q11,df_train$band11_7)

#df_train$ndvi_1_7 = ifelse(is.na(df_train$ndvi_1_7),q12,df_train$ndvi_1_7)
###
q = raster::extract(band1, test_points)
q2 = raster::extract(band2, test_points)
q3 = raster::extract(band3, test_points)
q4 = raster::extract(band4, test_points)
q5 = raster::extract(band5, test_points)
q6 = raster::extract(band6, test_points)
q7 = raster::extract(band7, test_points)
q8 = raster::extract(band8, test_points)
q9 = raster::extract(band9, test_points)
q10 = raster::extract(band10, test_points)
q11 = raster::extract(band11, test_points)
#q12 = raster::extract(ndvi_11_5,test_points)

df_test$band1_7 = ifelse(is.na(df_test$band1_7),q,df_test$band1_7)
df_test$band2_7 = ifelse(is.na(df_test$band2_7),q2,df_test$band2_7)
df_test$band3_7 = ifelse(is.na(df_test$band3_7),q3,df_test$band3_7)
df_test$band4_7 = ifelse(is.na(df_test$band4_7),q4,df_test$band4_7)
df_test$band5_7 = ifelse(is.na(df_test$band5_7),q5,df_test$band5_7)
df_test$band6_7 = ifelse(is.na(df_test$band6_7),q6,df_test$band6_7)
df_test$band7_7 = ifelse(is.na(df_test$band7_7),q7,df_test$band7_7)
df_test$band8_7 = ifelse(is.na(df_test$band8_7),q8,df_test$band8_7)
df_test$band9_7 = ifelse(is.na(df_test$band9_7),q9,df_test$band9_7)
df_test$band10_7 = ifelse(is.na(df_test$band10_7),q10,df_test$band10_7)
df_test$band11_7 = ifelse(is.na(df_test$band11_7),q11,df_test$band11_7)
#df_test$ndvi_1_7 = ifelse(is.na(df_test$ndvi_1_7),q12,df_test$ndvi_1_7)


###############################
###### 2017-01-31
band1 = raster::raster(paste0(img.dir6,'/T34JFP_20170131T082151_B01.jp2'))
band2 = raster::raster(paste0(img.dir6,'/T34JFP_20170131T082151_B02.jp2'))
band3 = raster::raster(paste0(img.dir6,'/T34JFP_20170131T082151_B03.jp2'))
band4 = raster::raster(paste0(img.dir6,'/T34JFP_20170131T082151_B04.jp2'))
band5 = raster::raster(paste0(img.dir6,'/T34JFP_20170131T082151_B05.jp2'))
band6 = raster::raster(paste0(img.dir6,'/T34JFP_20170131T082151_B06.jp2'))
band7 = raster::raster(paste0(img.dir6,'/T34JFP_20170131T082151_B07.jp2'))
band8 = raster::raster(paste0(img.dir6,'/T34JFP_20170131T082151_B08.jp2'))
band9 = raster::raster(paste0(img.dir6,'/T34JFP_20170131T082151_B09.jp2'))
band10 = raster::raster(paste0(img.dir6,'/T34JFP_20170131T082151_B10.jp2'))
band11 = raster::raster(paste0(img.dir6,'/T34JFP_20170131T082151_B11.jp2'))

##
q = raster::extract(band1,train_points)
q2 = raster::extract(band2,train_points)
q3 = raster::extract(band3,train_points)
q4 = raster::extract(band4,train_points)
q5 = raster::extract(band5,train_points)
q6 = raster::extract(band6,train_points)
q7 = raster::extract(band7,train_points)
q8 = raster::extract(band8,train_points)
q9 = raster::extract(band9,train_points)
q10 = raster::extract(band10,train_points)
q11 = raster::extract(band11,train_points)
#q12 = raster::extract(ndvi_11_5,train_points)

df_train$band1_1 = ifelse(is.na(df_train$band1_1),q,df_train$band1_1)
df_train$band2_1 = ifelse(is.na(df_train$band2_1),q2,df_train$band2_1)
df_train$band3_1 = ifelse(is.na(df_train$band3_1),q3,df_train$band3_1)
df_train$band4_1 = ifelse(is.na(df_train$band4_1),q4,df_train$band4_1)
df_train$band5_1 = ifelse(is.na(df_train$band5_1),q5,df_train$band5_1)
df_train$band6_1 = ifelse(is.na(df_train$band6_1),q6,df_train$band6_1)
df_train$band7_1 = ifelse(is.na(df_train$band7_1),q7,df_train$band7_1)
df_train$band8_1 = ifelse(is.na(df_train$band8_1),q8,df_train$band8_1)
df_train$band9_1 = ifelse(is.na(df_train$band9_1),q9,df_train$band9_1)
df_train$band10_1 = ifelse(is.na(df_train$band10_1),q10,df_train$band10_1)
df_train$band11_1 = ifelse(is.na(df_train$band11_1),q11,df_train$band11_1)
#df_train$ndvi_1_7 = ifelse(is.na(df_train$ndvi_1_7),q12,df_train$ndvi_1_7)
###
q = raster::extract(band1, test_points)
q2 = raster::extract(band2, test_points)
q3 = raster::extract(band3, test_points)
q4 = raster::extract(band4, test_points)
q5 = raster::extract(band5, test_points)
q6 = raster::extract(band6, test_points)
q7 = raster::extract(band7, test_points)
q8 = raster::extract(band8, test_points)
q9 = raster::extract(band9, test_points)
q10 = raster::extract(band10, test_points)
q11 = raster::extract(band11, test_points)
# q12 = raster::extract(ndvi_11_5,test_points)

df_test$band1_1 = ifelse(is.na(df_test$band1_1),q,df_test$band1_1)
df_test$band2_1 = ifelse(is.na(df_test$band2_1),q2,df_test$band2_1)
df_test$band3_1 = ifelse(is.na(df_test$band3_1),q3,df_test$band3_1)
df_test$band4_1 = ifelse(is.na(df_test$band4_1),q4,df_test$band4_1)
df_test$band5_1 = ifelse(is.na(df_test$band5_1),q5,df_test$band5_1)
df_test$band6_1 = ifelse(is.na(df_test$band6_1),q6,df_test$band6_1)
df_test$band7_1 = ifelse(is.na(df_test$band7_1),q7,df_test$band7_1)
df_test$band8_1 = ifelse(is.na(df_test$band8_1),q8,df_test$band8_1)
df_test$band9_1 = ifelse(is.na(df_test$band9_1),q9,df_test$band9_1)
df_test$band10_1 = ifelse(is.na(df_test$band10_1),q10,df_test$band10_1)
df_test$band11_1 = ifelse(is.na(df_test$band11_1),q11,df_test$band11_1)
# df_test$ndvi_1_7 = ifelse(is.na(df_test$ndvi_1_7),q12,df_test$ndvi_1_7)


########################
###### 2017-07-15
band1 = raster::raster(paste0(img.dir4,'/T34JFP_20170715T081609_B01.jp2'))
band2 = raster::raster(paste0(img.dir4,'/T34JFP_20170715T081609_B02.jp2'))
band3 = raster::raster(paste0(img.dir4,'/T34JFP_20170715T081609_B03.jp2'))
band4 = raster::raster(paste0(img.dir4,'/T34JFP_20170715T081609_B04.jp2'))
band5 = raster::raster(paste0(img.dir4,'/T34JFP_20170715T081609_B05.jp2'))
band6 = raster::raster(paste0(img.dir4,'/T34JFP_20170715T081609_B06.jp2'))
band7 = raster::raster(paste0(img.dir4,'/T34JFP_20170715T081609_B07.jp2'))
band8 = raster::raster(paste0(img.dir4,'/T34JFP_20170715T081609_B08.jp2'))
band9 = raster::raster(paste0(img.dir4,'/T34JFP_20170715T081609_B09.jp2'))
band10 = raster::raster(paste0(img.dir4,'/T34JFP_20170715T081609_B10.jp2'))
band11 = raster::raster(paste0(img.dir4,'/T34JFP_20170715T081609_B11.jp2'))

##
q = raster::extract(band1,train_points)
q2 = raster::extract(band2,train_points)
q3 = raster::extract(band3,train_points)
q4 = raster::extract(band4,train_points)
q5 = raster::extract(band5,train_points)
q6 = raster::extract(band6,train_points)
q7 = raster::extract(band7,train_points)
q8 = raster::extract(band8,train_points)
q9 = raster::extract(band9,train_points)
q10 = raster::extract(band10,train_points)
q11 = raster::extract(band11,train_points)
#q12 = raster::extract(ndvi_11_5,train_points)

df_train$band1_4 = ifelse(is.na(df_train$band1_4),q,df_train$band1_4)
df_train$band2_4 = ifelse(is.na(df_train$band2_4),q2,df_train$band2_4)
df_train$band3_4 = ifelse(is.na(df_train$band3_4),q3,df_train$band3_4)
df_train$band4_4 = ifelse(is.na(df_train$band4_4),q4,df_train$band4_4)
df_train$band5_4 = ifelse(is.na(df_train$band5_4),q5,df_train$band5_4)
df_train$band6_4 = ifelse(is.na(df_train$band6_4),q6,df_train$band6_4)
df_train$band7_4 = ifelse(is.na(df_train$band7_4),q7,df_train$band7_4)
df_train$band8_4 = ifelse(is.na(df_train$band8_4),q8,df_train$band8_4)
df_train$band9_4 = ifelse(is.na(df_train$band9_4),q9,df_train$band9_4)
df_train$band10_4 = ifelse(is.na(df_train$band10_4),q10,df_train$band10_4)
df_train$band11_4 = ifelse(is.na(df_train$band11_4),q11,df_train$band11_4)
#df_train$ndvi_1_7 = ifelse(is.na(df_train$ndvi_1_7),q12,df_train$ndvi_1_7)
###
q = raster::extract(band1, test_points)
q2 = raster::extract(band2, test_points)
q3 = raster::extract(band3, test_points)
q4 = raster::extract(band4, test_points)
q5 = raster::extract(band5, test_points)
q6 = raster::extract(band6, test_points)
q7 = raster::extract(band7, test_points)
q8 = raster::extract(band8, test_points)
q9 = raster::extract(band9, test_points)
q10 = raster::extract(band10, test_points)
q11 = raster::extract(band11, test_points)
# q12 = raster::extract(ndvi_11_5,test_points)

df_test$band1_4 = ifelse(is.na(df_test$band1_4),q,df_test$band1_4)
df_test$band2_4 = ifelse(is.na(df_test$band2_4),q2,df_test$band2_4)
df_test$band3_4 = ifelse(is.na(df_test$band3_4),q3,df_test$band3_4)
df_test$band4_4 = ifelse(is.na(df_test$band4_4),q4,df_test$band4_4)
df_test$band5_4 = ifelse(is.na(df_test$band5_4),q5,df_test$band5_4)
df_test$band6_4 = ifelse(is.na(df_test$band6_4),q6,df_test$band6_4)
df_test$band7_4 = ifelse(is.na(df_test$band7_4),q7,df_test$band7_4)
df_test$band8_4 = ifelse(is.na(df_test$band8_4),q8,df_test$band8_4)
df_test$band9_4 = ifelse(is.na(df_test$band9_4),q9,df_test$band9_4)
df_test$band10_4 = ifelse(is.na(df_test$band10_4),q10,df_test$band10_4)
df_test$band11_4 = ifelse(is.na(df_test$band11_4),q11,df_test$band11_4)
# df_test$ndvi_1_7 = ifelse(is.na(df_test$ndvi_1_7),q12,df_test$ndvi_1_7)


#########################
###### 2017-07-10
band1 = raster::raster(paste0(img.dir42,'/T34JFP_20170710T082011_B01.jp2'))
band2 = raster::raster(paste0(img.dir42,'/T34JFP_20170710T082011_B02.jp2'))
band3 = raster::raster(paste0(img.dir42,'/T34JFP_20170710T082011_B03.jp2'))
band4 = raster::raster(paste0(img.dir42,'/T34JFP_20170710T082011_B04.jp2'))
band5 = raster::raster(paste0(img.dir42,'/T34JFP_20170710T082011_B05.jp2'))
band6 = raster::raster(paste0(img.dir42,'/T34JFP_20170710T082011_B06.jp2'))
band7 = raster::raster(paste0(img.dir42,'/T34JFP_20170710T082011_B07.jp2'))
band8 = raster::raster(paste0(img.dir42,'/T34JFP_20170710T082011_B08.jp2'))
band9 = raster::raster(paste0(img.dir42,'/T34JFP_20170710T082011_B09.jp2'))
band10 = raster::raster(paste0(img.dir42,'/T34JFP_20170710T082011_B10.jp2'))
band11 = raster::raster(paste0(img.dir42,'/T34JFP_20170710T082011_B11.jp2'))

##
q = raster::extract(band1,train_points)
q2 = raster::extract(band2,train_points)
q3 = raster::extract(band3,train_points)
q4 = raster::extract(band4,train_points)
q5 = raster::extract(band5,train_points)
q6 = raster::extract(band6,train_points)
q7 = raster::extract(band7,train_points)
q8 = raster::extract(band8,train_points)
q9 = raster::extract(band9,train_points)
q10 = raster::extract(band10,train_points)
q11 = raster::extract(band11,train_points)
#q12 = raster::extract(ndvi_11_5,train_points)

df_train$band1_42 = ifelse(is.na(df_train$band1_42),q,df_train$band1_42)
df_train$band2_42 = ifelse(is.na(df_train$band2_42),q2,df_train$band2_42)
df_train$band3_42 = ifelse(is.na(df_train$band3_42),q3,df_train$band3_42)
df_train$band4_42 = ifelse(is.na(df_train$band4_42),q4,df_train$band4_42)
df_train$band5_42 = ifelse(is.na(df_train$band5_42),q5,df_train$band5_42)
df_train$band6_42 = ifelse(is.na(df_train$band6_42),q6,df_train$band6_42)
df_train$band7_42 = ifelse(is.na(df_train$band7_42),q7,df_train$band7_42)
df_train$band8_42 = ifelse(is.na(df_train$band8_42),q8,df_train$band8_42)
df_train$band9_42 = ifelse(is.na(df_train$band9_42),q9,df_train$band9_42)
df_train$band10_42 = ifelse(is.na(df_train$band10_42),q10,df_train$band10_42)
df_train$band11_42 = ifelse(is.na(df_train$band11_42),q11,df_train$band11_42)
#df_train$ndvi_1_7 = ifelse(is.na(df_train$ndvi_1_7),q12,df_train$ndvi_1_7)
q = raster::extract(band1,test_points)
q2 = raster::extract(band2,test_points)
q3 = raster::extract(band3,test_points)
q4 = raster::extract(band4,test_points)
q5 = raster::extract(band5,test_points)
q6 = raster::extract(band6,test_points)
q7 = raster::extract(band7,test_points)
q8 = raster::extract(band8,test_points)
q9 = raster::extract(band9,test_points)
q10 = raster::extract(band10,test_points)
q11 = raster::extract(band11,test_points)
#q12 = raster::extract(ndvi_11_5,train_points)

df_test$band1_42 = ifelse(is.na(df_test$band1_42),q,df_test$band1_42)
df_test$band2_42 = ifelse(is.na(df_test$band2_42),q2,df_test$band2_42)
df_test$band3_42 = ifelse(is.na(df_test$band3_42),q3,df_test$band3_42)
df_test$band4_42 = ifelse(is.na(df_test$band4_42),q4,df_test$band4_42)
df_test$band5_42 = ifelse(is.na(df_test$band5_42),q5,df_test$band5_42)
df_test$band6_42 = ifelse(is.na(df_test$band6_42),q6,df_test$band6_42)
df_test$band7_42 = ifelse(is.na(df_test$band7_42),q7,df_test$band7_42)
df_test$band8_42 = ifelse(is.na(df_test$band8_42),q8,df_test$band8_42)
df_test$band9_42 = ifelse(is.na(df_test$band9_42),q9,df_test$band9_42)
df_test$band10_42 = ifelse(is.na(df_test$band10_42),q10,df_test$band10_42)
df_test$band11_42 = ifelse(is.na(df_test$band11_42),q11,df_test$band11_42)

#######################
###### 2017-02-10
band1 = raster::raster(paste0(img.dir2,'/T34JFP_20170210T082051_B01.jp2'))
band2 = raster::raster(paste0(img.dir2,'/T34JFP_20170210T082051_B02.jp2'))
band3 = raster::raster(paste0(img.dir2,'/T34JFP_20170210T082051_B03.jp2'))
band4 = raster::raster(paste0(img.dir2,'/T34JFP_20170210T082051_B04.jp2'))
band5 = raster::raster(paste0(img.dir2,'/T34JFP_20170210T082051_B05.jp2'))
band6 = raster::raster(paste0(img.dir2,'/T34JFP_20170210T082051_B06.jp2'))
band7 = raster::raster(paste0(img.dir2,'/T34JFP_20170210T082051_B07.jp2'))
band8 = raster::raster(paste0(img.dir2,'/T34JFP_20170210T082051_B08.jp2'))
band9 = raster::raster(paste0(img.dir2,'/T34JFP_20170210T082051_B09.jp2'))
band10 = raster::raster(paste0(img.dir2,'/T34JFP_20170210T082051_B10.jp2'))
band11 = raster::raster(paste0(img.dir2,'/T34JFP_20170210T082051_B11.jp2'))

##
q = raster::extract(band1,train_points)
q2 = raster::extract(band2,train_points)
q3 = raster::extract(band3,train_points)
q4 = raster::extract(band4,train_points)
q5 = raster::extract(band5,train_points)
q6 = raster::extract(band6,train_points)
q7 = raster::extract(band7,train_points)
q8 = raster::extract(band8,train_points)
q9 = raster::extract(band9,train_points)
q10 = raster::extract(band10,train_points)
q11 = raster::extract(band11,train_points)
#q12 = raster::extract(ndvi_11_5,train_points)

df_train$band1_6 = ifelse(is.na(df_train$band1_6),q,df_train$band1_6)
df_train$band2_6 = ifelse(is.na(df_train$band2_6),q2,df_train$band2_6)
df_train$band3_6 = ifelse(is.na(df_train$band3_6),q3,df_train$band3_6)
df_train$band4_6 = ifelse(is.na(df_train$band4_6),q4,df_train$band4_6)
df_train$band5_6 = ifelse(is.na(df_train$band5_6),q5,df_train$band5_6)
df_train$band6_6 = ifelse(is.na(df_train$band6_6),q6,df_train$band6_6)
df_train$band7_6 = ifelse(is.na(df_train$band7_6),q7,df_train$band7_6)
df_train$band8_6 = ifelse(is.na(df_train$band8_6),q8,df_train$band8_6)
df_train$band9_6 = ifelse(is.na(df_train$band9_6),q9,df_train$band9_6)
df_train$band10_6 = ifelse(is.na(df_train$band10_6),q10,df_train$band10_6)
df_train$band11_6 = ifelse(is.na(df_train$band11_6),q11,df_train$band11_6)
#df_train$ndvi_1_7 = ifelse(is.na(df_train$ndvi_1_7),q12,df_train$ndvi_1_7)

q = raster::extract(band1,test_points)
q2 = raster::extract(band2,test_points)
q3 = raster::extract(band3,test_points)
q4 = raster::extract(band4,test_points)
q5 = raster::extract(band5,test_points)
q6 = raster::extract(band6,test_points)
q7 = raster::extract(band7,test_points)
q8 = raster::extract(band8,test_points)
q9 = raster::extract(band9,test_points)
q10 = raster::extract(band10,test_points)
q11 = raster::extract(band11,test_points)
#q12 = raster::extract(ndvi_11_5,train_points)

df_test$band1_6 = ifelse(is.na(df_test$band1_6),q,df_test$band1_6)
df_test$band2_6 = ifelse(is.na(df_test$band2_6),q2,df_test$band2_6)
df_test$band3_6 = ifelse(is.na(df_test$band3_6),q3,df_test$band3_6)
df_test$band4_6 = ifelse(is.na(df_test$band4_6),q4,df_test$band4_6)
df_test$band5_6 = ifelse(is.na(df_test$band5_6),q5,df_test$band5_6)
df_test$band6_6 = ifelse(is.na(df_test$band6_6),q6,df_test$band6_6)
df_test$band7_6 = ifelse(is.na(df_test$band7_6),q7,df_test$band7_6)
df_test$band8_6 = ifelse(is.na(df_test$band8_6),q8,df_test$band8_6)
df_test$band9_6 = ifelse(is.na(df_test$band9_6),q9,df_test$band9_6)
df_test$band10_6 = ifelse(is.na(df_test$band10_6),q10,df_test$band10_6)
df_test$band11_6 = ifelse(is.na(df_test$band11_6),q11,df_test$band11_6)



################################
###### 2017-03-22
band1 = raster::raster(paste0(img.dir1,'/T34JFP_20170322T081611_B01.jp2'))
band2 = raster::raster(paste0(img.dir1,'/T34JFP_20170322T081611_B02.jp2'))
band3 = raster::raster(paste0(img.dir1,'/T34JFP_20170322T081611_B03.jp2'))
band4 = raster::raster(paste0(img.dir1,'/T34JFP_20170322T081611_B04.jp2'))
band5 = raster::raster(paste0(img.dir1,'/T34JFP_20170322T081611_B05.jp2'))
band6 = raster::raster(paste0(img.dir1,'/T34JFP_20170322T081611_B06.jp2'))
band7 = raster::raster(paste0(img.dir1,'/T34JFP_20170322T081611_B07.jp2'))
band8 = raster::raster(paste0(img.dir1,'/T34JFP_20170322T081611_B08.jp2'))
band8A = raster::raster(paste0(img.dir1,'/T34JFP_20170322T081611_B8A.jp2'))
band9 = raster::raster(paste0(img.dir1,'/T34JFP_20170322T081611_B09.jp2'))
band10 = raster::raster(paste0(img.dir1,'/T34JFP_20170322T081611_B10.jp2'))
band11 = raster::raster(paste0(img.dir1,'/T34JFP_20170322T081611_B11.jp2'))

##
q = raster::extract(band1,train_points)
q2 = raster::extract(band2,train_points)
q3 = raster::extract(band3,train_points)
q4 = raster::extract(band4,train_points)
q5 = raster::extract(band5,train_points)
q6 = raster::extract(band6,train_points)
q7 = raster::extract(band7,train_points)
q8 = raster::extract(band8,train_points)
q8A = raster::extract(band8A,train_points)
q9 = raster::extract(band9,train_points)
q10 = raster::extract(band10,train_points)
q11 = raster::extract(band11,train_points)
#q12 = raster::extract(ndvi_11_5,train_points)

df_train$band1_22 = ifelse(is.na(df_train$band1_22),q,df_train$band1_22)
df_train$band2_22 = ifelse(is.na(df_train$band2_22),q2,df_train$band2_22)
df_train$band3_22 = ifelse(is.na(df_train$band3_22),q3,df_train$band3_22)
df_train$band4_22 = ifelse(is.na(df_train$band4_22),q4,df_train$band4_22)
df_train$band5_22 = ifelse(is.na(df_train$band5_22),q5,df_train$band5_22)
df_train$band6_22 = ifelse(is.na(df_train$band6_22),q6,df_train$band6_22)
df_train$band7_22 = ifelse(is.na(df_train$band7_22),q7,df_train$band7_22)
df_train$band8_22 = ifelse(is.na(df_train$band8_22),q8,df_train$band8_22)
df_train$band8A_22 = ifelse(is.na(df_train$band8A_22),q8A,df_train$band8A_22)
df_train$band9_22 = ifelse(is.na(df_train$band9_22),q9,df_train$band9_22)
df_train$band10_22 = ifelse(is.na(df_train$band10_22),q10,df_train$band10_22)
df_train$band11_22 = ifelse(is.na(df_train$band11_22),q11,df_train$band11_22)

q = raster::extract(band1,test_points)
q2 = raster::extract(band2,test_points)
q3 = raster::extract(band3,test_points)
q4 = raster::extract(band4,test_points)
q5 = raster::extract(band5,test_points)
q6 = raster::extract(band6,test_points)
q7 = raster::extract(band7,test_points)
q8 = raster::extract(band8,test_points)
q9 = raster::extract(band9,test_points)
q10 = raster::extract(band10,test_points)
q11 = raster::extract(band11,test_points)
#q12 = raster::extract(ndvi_11_5,train_points)

df_test$band1_22 = ifelse(is.na(df_test$band1_22),q,df_test$band1_22)
df_test$band2_22 = ifelse(is.na(df_test$band2_22),q2,df_test$band2_22)
df_test$band3_22 = ifelse(is.na(df_test$band3_22),q3,df_test$band3_22)
df_test$band4_22 = ifelse(is.na(df_test$band4_22),q4,df_test$band4_22)
df_test$band5_22 = ifelse(is.na(df_test$band5_22),q5,df_test$band5_22)
df_test$band6_22 = ifelse(is.na(df_test$band6_22),q6,df_test$band6_22)
df_test$band7_22 = ifelse(is.na(df_test$band7_22),q7,df_test$band7_22)
df_test$band8_22 = ifelse(is.na(df_test$band8_22),q8,df_test$band8_22)
df_test$band9_22 = ifelse(is.na(df_test$band9_22),q9,df_test$band9_22)
df_test$band10_22 = ifelse(is.na(df_test$band10_22),q10,df_test$band10_22)
df_test$band11_22 = ifelse(is.na(df_test$band11_22),q11,df_test$band11_22)


########################
###### 2017-06-20
band1 = raster::raster(paste0(img.dir66,'/T34JFP_20170620T082011_B01.jp2'))
band2 = raster::raster(paste0(img.dir66,'/T34JFP_20170620T082011_B02.jp2'))
band3 = raster::raster(paste0(img.dir66,'/T34JFP_20170620T082011_B03.jp2'))
band4 = raster::raster(paste0(img.dir66,'/T34JFP_20170620T082011_B04.jp2'))
band5 = raster::raster(paste0(img.dir66,'/T34JFP_20170620T082011_B05.jp2'))
band6 = raster::raster(paste0(img.dir66,'/T34JFP_20170620T082011_B06.jp2'))
band7 = raster::raster(paste0(img.dir66,'/T34JFP_20170620T082011_B07.jp2'))
band8 = raster::raster(paste0(img.dir66,'/T34JFP_20170620T082011_B08.jp2'))
band9 = raster::raster(paste0(img.dir66,'/T34JFP_20170620T082011_B09.jp2'))
band10 = raster::raster(paste0(img.dir66,'/T34JFP_20170620T082011_B10.jp2'))
band11 = raster::raster(paste0(img.dir66,'/T34JFP_20170620T082011_B11.jp2'))
bandTC = raster::raster(paste0(img.dir66,'/T34JFP_20170620T082011_TCI.jp2'))
##
q = raster::extract(band1,train_points)
q2 = raster::extract(band2,train_points)
q3 = raster::extract(band3,train_points)
q4 = raster::extract(band4,train_points)
q5 = raster::extract(band5,train_points)
q6 = raster::extract(band6,train_points)
q7 = raster::extract(band7,train_points)
q8 = raster::extract(band8,train_points)
q9 = raster::extract(band9,train_points)
q10 = raster::extract(band10,train_points)
q11 = raster::extract(band11,train_points)
q12 = raster::extract(bandTC,train_points)

df_train$band1_66 = ifelse(is.na(df_train$band1_66),q,df_train$band1_66)
df_train$band2_66 = ifelse(is.na(df_train$band2_66),q2,df_train$band2_66)
df_train$band3_66 = ifelse(is.na(df_train$band3_66),q3,df_train$band3_66)
df_train$band4_66 = ifelse(is.na(df_train$band4_66),q4,df_train$band4_66)
df_train$band5_66 = ifelse(is.na(df_train$band5_66),q5,df_train$band5_66)
df_train$band6_66 = ifelse(is.na(df_train$band6_66),q6,df_train$band6_66)
df_train$band7_66 = ifelse(is.na(df_train$band7_66),q7,df_train$band7_66)
df_train$band8_66 = ifelse(is.na(df_train$band8_66),q8,df_train$band8_66)
df_train$band9_66 = ifelse(is.na(df_train$band9_66),q9,df_train$band9_66)
df_train$band10_66 = ifelse(is.na(df_train$band10_66),q10,df_train$band10_66)
df_train$band11_66 = ifelse(is.na(df_train$band11_66),q11,df_train$band11_66)
df_train$bandtc_66 = ifelse(is.na(df_train$bandtc_66),q12,df_train$bandtc_66)


q = raster::extract(band1,test_points)
q2 = raster::extract(band2,test_points)
q3 = raster::extract(band3,test_points)
q4 = raster::extract(band4,test_points)
q5 = raster::extract(band5,test_points)
q6 = raster::extract(band6,test_points)
q7 = raster::extract(band7,test_points)
q8 = raster::extract(band8,test_points)
q9 = raster::extract(band9,test_points)
q10 = raster::extract(band10,test_points)
q11 = raster::extract(band11,test_points)
#q12 = raster::extract(ndvi_11_5,train_points)

df_test$band1_66 = ifelse(is.na(df_test$band1_66),q,df_test$band1_66)
df_test$band2_66 = ifelse(is.na(df_test$band2_66),q2,df_test$band2_66)
df_test$band3_66 = ifelse(is.na(df_test$band3_66),q3,df_test$band3_66)
df_test$band4_66 = ifelse(is.na(df_test$band4_66),q4,df_test$band4_66)
df_test$band5_66 = ifelse(is.na(df_test$band5_66),q5,df_test$band5_66)
df_test$band6_66 = ifelse(is.na(df_test$band6_66),q6,df_test$band6_66)
df_test$band7_66 = ifelse(is.na(df_test$band7_66),q7,df_test$band7_66)
df_test$band8_66 = ifelse(is.na(df_test$band8_66),q8,df_test$band8_66)
df_test$band9_66 = ifelse(is.na(df_test$band9_66),q9,df_test$band9_66)
df_test$band10_66 = ifelse(is.na(df_test$band10_66),q10,df_test$band10_66)
df_test$band11_66 = ifelse(is.na(df_test$band11_66),q11,df_test$band11_66)